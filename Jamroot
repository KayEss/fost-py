path-constant TOP : . ;
include $(TOP)/../boost-version.jam ;
include ../fost-base/fost.jam ;

using python ;
use-project Boost : ../Boost ;
use-project fost-base : ../fost-base ;
use-project fost-internet : ../fost-internet ;
use-project fost-orm : ../fost-orm ;

fost-project fost-py
    :
        <include>../fost-internet/Cpp/include
        <include>../fost-orm/Cpp/include
    ;


# A little "rule" (function) to clean up the syntax of declaring tests
# of these extension modules.
rule run-test ( test-name : sources + )
{
    import testing ;
    testing.make-test run-pyd : $(sources) : : $(test-name) ;
}

# An install rule for the Python libs
rule py-install ( pyd : location )
{
    local loc = "../../../dist/lib/python/site-packages/" $(location) ;
    install $(loc:J) : $(pyd) ;
}


fost-install-loc .. : ../Boost//boost-python-dll ;
build-project Cpp/fost-crypto-py/ ;
build-project Cpp/fost-fpython/ ;
build-project Cpp/fost-internet-py/ ;
build-project Cpp/fost-json-py/ ;
build-project Cpp/fost-pyhost/ ;
build-project Cpp/fost-pyhost-test/ ;
build-project Cpp/fost-python/ ;
build-project Cpp/fost-python-test/ ;
build-project Cpp/fost-schema-py/ ;
build-project Cpp/fost-settings-py/ ;
build-project Cpp/fost-wsgi/ ;
build-project Cpp/fost-wsgi-test/ ;
build-project Python/ ;

alias examples
    :
        Examples/wsgi/
    ;
explicit examples ;


import path ;
install ../dist/lib/python/site-packages/Fost
    :
        [ path.glob-tree Python/Fost : *.* : .svn *.py~ *.pyc *.so ]
    :
        <install-source-root>Python/Fost
    ;
